<ng-template id="modalWait" #modalWait let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4>Loading</h4>
  </div>
  <div class="modal-body">
    <div class="progress">
      <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 75%"></div>
    </div>
  </div>
</ng-template>

<ng-template id="modalResource" #modalResource let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4>{{resource.resourceType}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <div class="modal-body">

    <div class="row">
       <app-resource-viewer [resource]="resource"></app-resource-viewer>
    </div>
  </div>

</ng-template>



<ng-template id="modalIssue" #modalIssue let-c="close" let-d="dismiss">
  <div class="modal-header">

    <h4>Warning</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
      <div class="card-body">
        Unable to Load document.
      </div>
  </div>
</ng-template>
<mat-card>
  <mat-card-title>FHIR Document</mat-card-title>
  <mat-card-content>
<span *ngIf="systemType==='FDMS'">
    <div class="alert alert-primary">
      <div class="d-flex justify-content-between container-fluid">

        <strong>Generated from Structured Content</strong>

      </div>
    </div>
<!--
     <div *ngIf="patient!=undefined" class="container-fluid">
       <div class="card card-default">
           <app-patient-item [patient] = "patient" [detail]="true"> </app-patient-item>
       </div>
     </div>
-->
     <div *ngIf="composition!=undefined" class="container-fluid">

        <mat-card>
            <mat-card-title class="d-flex justify-content-between">
                <div>{{composition.title}}</div>
              <div>   <button mat-raised-button  placement="top" (click)="openResource(composition)"><mat-icon>code</mat-icon>
                Composition</button>
                <button mat-raised-button placement="top" (click)="openResource(patient)"><mat-icon>code</mat-icon>
                Patient</button>
                <span *ngIf="encounter != undefined"><button mat-raised-button  placement="top" (click)="openResource(encounter)"><mat-icon>code</mat-icon>
                Encounter</button></span>
              </div>
            </mat-card-title>
            <mat-card-content>
                <app-composition [composition] = "composition" [encounter]="encounter"></app-composition>
            </mat-card-content>
          </mat-card>
     </div>
    <br>
     <div class="alert alert-primary">
       <div class="d-flex justify-content-between">
           <strong>Supplied Narrative Content</strong>
         </div>
     </div>
 </span>
<div *ngIf="composition!=undefined" class="container-fluid">
  <div class="alert alert-info">
    <div class="d-flex justify-content-between">
      <div>
    <strong>{{composition.title}}</strong>
  {{composition.date | date: 'dd MMM yyyy HH:mm' }}
      </div>
      <div>

          <button mat-raised-button (click)="downloadPDF()">Export PDF</button>
          <button mat-raised-button (click)="downloadHTML()">Export html</button>
        </div>

    </div>
  </div>

  <div *ngIf="patient!=undefined && patient.text !=undefined" class="card card-default">

      <div class="card-header">
        <div class="d-flex w-100 justify-content-between">
          <h5>Patient</h5>
          <button mat-raised-button>View Structured Content</button>
        </div>
      </div>
    <div class="card-body" [innerHTML]="patient.text.div"></div>
  </div>
      <div *ngFor="let section of sections" >
          <app-view-document-section [section] = "section" [document]="document"></app-view-document-section>
      </div>

</div>
  </mat-card-content>
</mat-card>
